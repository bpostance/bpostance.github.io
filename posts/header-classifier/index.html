<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Using machine learning to cleanse datasets: classifying column headers in data tables" /><meta name="author" content="Ben Postance" /><meta property="og:locale" content="en_US" /><meta name="description" content="When dealing with large volumes of inbound data files and from multiple different sources, the data recieved can often come in a variety of formats, structures and to varying standards. One particularly challenging issue is data files that, although representing the same type of information, feature a variety of different label and data formats. For instance, addresses coded with “Zip” or “Postal Code”, “Street” or “Line 1” and “£1000”, “£1 K”, “GBP 1000” or “one thousand pounds”." /><meta property="og:description" content="When dealing with large volumes of inbound data files and from multiple different sources, the data recieved can often come in a variety of formats, structures and to varying standards. One particularly challenging issue is data files that, although representing the same type of information, feature a variety of different label and data formats. For instance, addresses coded with “Zip” or “Postal Code”, “Street” or “Line 1” and “£1000”, “£1 K”, “GBP 1000” or “one thousand pounds”." /><link rel="canonical" href="https://bpostance.github.io/posts/header-classifier/" /><meta property="og:url" content="https://bpostance.github.io/posts/header-classifier/" /><meta property="og:site_name" content="Ben Postance" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-08-27T19:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Using machine learning to cleanse datasets: classifying column headers in data tables" /><meta name="twitter:site" content="@benpostance" /><meta name="twitter:creator" content="@Ben Postance" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ben Postance"},"dateModified":"2021-03-12T15:32:46+00:00","datePublished":"2019-08-27T19:00:00+01:00","description":"When dealing with large volumes of inbound data files and from multiple different sources, the data recieved can often come in a variety of formats, structures and to varying standards. One particularly challenging issue is data files that, although representing the same type of information, feature a variety of different label and data formats. For instance, addresses coded with “Zip” or “Postal Code”, “Street” or “Line 1” and “£1000”, “£1 K”, “GBP 1000” or “one thousand pounds”.","headline":"Using machine learning to cleanse datasets: classifying column headers in data tables","mainEntityOfPage":{"@type":"WebPage","@id":"https://bpostance.github.io/posts/header-classifier/"},"url":"https://bpostance.github.io/posts/header-classifier/"}</script><title>Using machine learning to cleanse datasets: classifying column headers in data tables | Ben Postance</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> // see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> MathJax = { tex: { inlineMath: [ // start/end delimiter pairs for in-line math ['$','$'], ['\\(','\\)'] ], displayMath: [ // start/end delimiter pairs for display math ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-140894462-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-140894462-1'); }); </script><body data-spy="scroll" data-target="#toc"><div id="top"></div><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/7165735?s=460&u=7ca34b8152bbff087bfc860cc87a4c35b4f9cb1b&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ben Postance</a></div><div class="site-subtitle font-italic">Risk, Data Science and Machine Learning</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT ME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/bpostance" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/benpostance" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['benpostance','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Using machine learning to cleanse datasets: classifying column headers in data tables</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Using machine learning to cleanse datasets: classifying column headers in data tables</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Ben Postance </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Aug 27, 2019, 7:00 PM +0100" prep="on" > Aug 27, 2019 <i class="unloaded">2019-08-27T19:00:00+01:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Fri, Mar 12, 2021, 3:32 PM +0000" prefix="Updated " > Mar 12, 2021 <i class="unloaded">2021-03-12T15:32:46+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2113 words">11 min</span></div></div><div class="post-content"><p>When dealing with large volumes of inbound data files and from multiple different sources, the data recieved can often come in a variety of formats, structures and to varying standards. One particularly challenging issue is data files that, although representing the same type of information, feature a variety of different label and data formats. For instance, addresses coded with “Zip” or “Postal Code”, “Street” or “Line 1” and “£1000”, “£1 K”, “GBP 1000” or “one thousand pounds”.</p><p>The Machine Learning solution is to build a model that can ingest messy labelled data (i.e. missing and with variable field names) and to make predctions for what the data fields are. These models can then be integrated within data transformation pipelines to automatically or to make suggestions of the correct data labels.</p><p>*Jupyter notebooks to recreate the synthetic dataset and to train and test the model are avaliable in this <a href="https://github.com/bpostance/table.header.classifier">Git repo</a></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1"># load packages
</span><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">import</span> <span class="n">os</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># change the paths to your local directory
</span><span class="n">data_path</span> <span class="o">=</span> <span class="sh">'</span><span class="s">P:</span><span class="se">\\</span><span class="s">MyWork</span><span class="se">\\</span><span class="s">demoColumnTyper</span><span class="se">\\</span><span class="s">data</span><span class="sh">'</span>
<span class="n">data_path_external</span> <span class="o">=</span> <span class="sh">'</span><span class="s">P:</span><span class="se">\\</span><span class="s">MyWork</span><span class="se">\\</span><span class="s">demoColumnTyper</span><span class="se">\\</span><span class="s">data</span><span class="se">\\</span><span class="s">external</span><span class="sh">'</span>
<span class="n">data_path_model</span> <span class="o">=</span> <span class="sh">'</span><span class="s">P:</span><span class="se">\\</span><span class="s">MyWork</span><span class="se">\\</span><span class="s">demoColumnTyper</span><span class="se">\\</span><span class="s">data</span><span class="se">\\</span><span class="s">model</span><span class="sh">'</span>
</pre></table></code></div></div><h2 id="load-the-training-data">Load the training-data</h2><p><strong>Fields &amp; Formats</strong><br /> The training-data has the correct headers attached. We want to predict these on inbound messy “unlabelled” data. I have included some very generic data fields and common formats. For instance, <em>money</em> varies between text and symbol currency values and <em>phone</em> includes a variety of formats and extensions. We also have some generic text_categorical and numeric values in there.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">training_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path_model</span><span class="p">,</span><span class="sh">'</span><span class="s">training_data.csv</span><span class="sh">'</span><span class="p">))</span>
<span class="n">training_data</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>address1<th>address2<th>city<th>state<th>zip<th>lat<th>lng<th>money<th>reference<th>email<th>person_name<th>phone<th>first_name<th>last_name<th>txt_cat<th>num_cat<th>numeric<tbody><tr><th>0<td>1745 T Street Southeast<td>NaN<td>Washington<td>DC<td>20020<td>38.867033<td>-76.979235<td>GBP 487760.350<td>SPCH308<td>mex@yahoo.com<td>Kimberlee Turlington<td>0345 42 0274<td>Kimberlee<td>Turlington<td>B<td>3<td>5181<tr><th>1<td>6007 Applegate Lane<td>NaN<td>Louisville<td>KY<td>40219<td>38.134301<td>-85.649851<td>€ 7321963.108<td>VDEY870<td>rg@aol.com<td>Miguel Eveland<td>095086-173-31-37<td>Miguel<td>Eveland<td>A<td>4<td>2163<tr><th>2<td>560 Penstock Drive<td>NaN<td>Grass Valley<td>CA<td>95945<td>39.213076<td>-121.077583<td>EUR 3341992.053<td>ZFPH671<td>ejbyy@hotmail.com<td>Alonzo Schroyer<td>057843 018 15-85<td>Alonzo<td>Schroyer<td>D<td>4<td>8193<tr><th>3<td>150 Carter Street<td>NaN<td>Manchester<td>CT<td>6040<td>41.765560<td>-72.473091<td>€ 4397323.917<td>WMDG542<td>tfanfw@gmail.com<td>Devon Osei<td>0698-1368378<td>Devon<td>Osei<td>C<td>1<td>6134<tr><th>4<td>2721 Lindsay Avenue<td>NaN<td>Louisville<td>KY<td>40206<td>38.263793<td>-85.700243<td>$ 7755233.425<td>SLLE128<td>xm@hotmail.com<td>Val Hoffmeyer<td>007 916 73 79<td>Val<td>Hoffmeyer<td>E<td>0<td>6663</table></div><h3 id="reshape-our-training-data-so-that-it-is-ready-for-modelling">Reshape our training-data so that it is ready for modelling.</h3><p><em>Using “X”, we want to predict our target variable “Y”</em></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="n">Xy</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">concat</span><span class="p">([</span><span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">:</span><span class="nf">list</span><span class="p">(</span><span class="n">training_data</span><span class="p">[</span><span class="n">col</span><span class="p">]),</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">:</span><span class="n">col</span><span class="p">})</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">training_data</span><span class="p">.</span><span class="n">columns</span><span class="p">])</span>
<span class="n">Xy</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Xy</span><span class="p">.</span><span class="nf">fillna</span><span class="p">(</span><span class="sh">''</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># fill nan values with empty string
</span><span class="n">Xy</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>X<th>Y<tbody><tr><th>24710<td>Dung<td>first_name<tr><th>15162<td>GBP 7421858.699<td>money<tr><th>12446<td>-76.9858<td>lng<tr><th>8184<td>95776<td>zip<tr><th>245<td>320 Northwest 22nd Street<td>address1</table></div><h2 id="feature-engineering---simple">Feature Engineering - simple</h2><p>In raw text form the training-data values of X are unreadable by a computer.<br /> We must engineer numeric representations termed features of the X values.</p><p>Here we define a function to create some generic features on our X data:</p><ul><li>length — The length of each string in characters<li>num_length — The number of digits characters in a string<li>space_length — The number of spaces within a string<li>special_length — The number of special (non-alphanumeric) characters<li>vowel_length - the number of vowels</ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">feat_eng</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s"> function to engineer basic text features </span><span class="sh">"""</span>
    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">).</span><span class="nf">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">n_chars</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span> <span class="c1"># string length
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">n_digits</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">[0-9]</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># n digits
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">n_space</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s"> </span><span class="sh">'</span><span class="p">)</span> <span class="c1"># n spaces
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">n_special</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">len</span><span class="p">()</span> <span class="o">-</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">[\w+ ]</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># n special chars
</span>    <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">n_vowels</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">(?i)[aeiou]</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># n vowels
</span>    <span class="k">return</span> <span class="n">df</span><span class="p">.</span><span class="nf">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">Xy</span> <span class="o">=</span> <span class="nf">feat_eng</span><span class="p">(</span><span class="n">Xy</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="feature-engineering---advanced">Feature Engineering - advanced</h2><p>Here we use a more sophisticated approach to generate numeric features on our training data. It applies a simplified version of <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf">TF-IDF (wiki)</a>. TF-IDF is a statistic used to measure how unique and important a word is in the body of text. For instance, the word “and” appears in many texts and yields little information regarding the topic of the text. The word “lawsuit” is generally rarer and yields inormation about the topic of the text. Ok so this doesnt quite apply to this case as our texts are really just single values. However, we can still use this approach to identify and label key strings in our training data.</p><p>We can see below a sample of the output. The TF-IDF measure has identified a number of strings as <em>important</em>. These include the strings:</p><ul><li>“street”,”road” and “ave” (subset of “avenue”) related to address data.<li>currency symbols.<li>”@”, “.co” and “.com” on email addresses. I’d imagine this would change our results if we added a URL field to the training data?<li>We also see that small numbers 0,1,2 are returned. This is likely due to phone numbers beginning with zero and/or <a href="https://en.wikipedia.org/wiki/Benford%27s_law">Benfords law</a> of small numbers.</ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">TfidfVectorizer</span>
<span class="n">vectorizer</span> <span class="o">=</span> <span class="nc">TfidfVectorizer</span><span class="p">(</span><span class="n">analyzer</span><span class="o">=</span><span class="sh">'</span><span class="s">char</span><span class="sh">'</span><span class="p">,</span>
                             <span class="n">lowercase</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                             <span class="n">stop_words</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">max_df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                             <span class="n">min_df</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                             <span class="n">ngram_range</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span>
                             <span class="n">binary</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                             <span class="n">norm</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                             <span class="n">use_idf</span><span class="o">=</span><span class="bp">False</span>
                            <span class="p">)</span>

<span class="n">X_vect</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">Xy</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">))</span>
<span class="c1">#print(X_vect.shape)
</span>
<span class="n">X_vect_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">X_vect</span><span class="p">.</span><span class="nf">todense</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="p">.</span><span class="nf">get_feature_names</span><span class="p">())</span>
<span class="n">Xy_vect</span> <span class="o">=</span> <span class="n">Xy</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">X_vect_df</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">,</span><span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="nf">copy</span><span class="p">()</span>
<span class="c1">#Xy_vect[['X','£']].loc[Xy_vect['X'].str.contains('£')==True]
</span></pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Xy_vect</span><span class="p">.</span><span class="nf">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">)[[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">street</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">road</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">ave</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">£</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">$</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">@</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">.co</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">.com</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">drive</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">]]</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>X<th>street<th>road<th>ave<th>£<th>$<th>@<th>.co<th>.com<th>drive<th>0<tbody><tr><th>27454<td>Gural<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>22112<td>004-570 4-61<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>1.0<tr><th>22620<td>07 6246014<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>1.0<tr><th>10521<td>38.512894<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<tr><th>16661<td>VSQO404<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>0.0<td>1.0</table></div><h2 id="feature-selection---univariate">Feature Selection - univariate</h2><p>Ok. So that lest step actually created about 11,000 numeric features on our training data. We need to trim this down by selecting the data value features that we believe are most likley to be correlated to our target column headers. Lets use some Chi-square correlation analyses to test the features.</p><p><strong>If you want to skip the stats, the bar plot below shows the 75 features that were found to have the highest correlation to our target column headers that we want to predict.</strong></p><h3 id="chi-squared"><a href="https://machinelearningmastery.com/chi-squared-test-for-machine-learning/">Chi-squared</a></h3><p><em>The chi-square test is a statistical test of independence to determine the dependency of two variables. It shares similarities with coefficient of determination, R². However, chi-square test is only applicable to categorical or nominal data while R² is only applicable to numeric data.</em></p><ul><li>If Statistic &gt;= Critical Value: significant result, reject null hypothesis (H0), dependent. <em>There <strong>IS</strong> a relationship</em>.<li>If Statistic &lt; Critical Value: not significant result, fail to reject null hypothesis (H0), independent. <em>There <strong>IS NOT</strong> a relationship</em>.</ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="c1"># chi-squared test with similar proportions
</span><span class="kn">from</span> <span class="n">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2_contingency</span>
<span class="kn">from</span> <span class="n">scipy.stats</span> <span class="kn">import</span> <span class="n">chi2</span>

<span class="n">prob</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">prob</span>

<span class="c1"># run test
</span><span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="nf">chi2_contingency</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="nf">crosstab</span><span class="p">(</span><span class="n">Xy</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">],</span><span class="n">Xy</span><span class="p">[</span><span class="sh">'</span><span class="s">n_vowels</span><span class="sh">'</span><span class="p">]))</span>

<span class="c1"># dof
</span><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="s">dof=%d</span><span class="sh">'</span> <span class="o">%</span> <span class="n">dof</span><span class="p">)</span>

<span class="c1"># interpret test-statistic
</span><span class="n">prob</span> <span class="o">=</span> <span class="mf">0.95</span>
<span class="n">critical</span> <span class="o">=</span> <span class="n">chi2</span><span class="p">.</span><span class="nf">ppf</span><span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">dof</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="s">probability=%.3f, critical=%.3f, stat=%.3f</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">prob</span><span class="p">,</span> <span class="n">critical</span><span class="p">,</span> <span class="n">stat</span><span class="p">))</span>
<span class="k">if</span> <span class="nf">abs</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">critical</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\t</span><span class="s">Dependent (reject H0)</span><span class="sh">'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\t</span><span class="s">Independent (fail to reject H0)</span><span class="sh">'</span><span class="p">)</span>
    
    
<span class="c1"># interpret p-value
</span><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\n</span><span class="s">significance=%.3f, p=%.3f</span><span class="sh">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
<span class="k">if</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\t</span><span class="s">Dependent (reject H0)</span><span class="sh">'</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="se">\t</span><span class="s">Independent (fail to reject H0)</span><span class="sh">'</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>dof=240

probability=0.950, critical=277.138, stat=60001.619
	Dependent (reject H0)

significance=0.050, p=0.000
	Dependent (reject H0)
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="n">features</span> <span class="o">=</span> <span class="n">Xy_vect</span><span class="p">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span>
<span class="n">stats</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>
<span class="n">dofs</span> <span class="o">=</span> <span class="nf">list</span><span class="p">()</span>

<span class="k">for</span> <span class="n">feat</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
    <span class="c1"># run test
</span>    <span class="n">stat</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="nf">chi2_contingency</span><span class="p">(</span><span class="n">pd</span><span class="p">.</span><span class="nf">crosstab</span><span class="p">(</span><span class="n">Xy_vect</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">],</span><span class="n">Xy_vect</span><span class="p">[</span><span class="n">feat</span><span class="p">]))</span>
    <span class="n">stats</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
    <span class="n">p_values</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="n">dofs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">dof</span><span class="p">)</span>

<span class="n">chi2_results</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span><span class="sh">'</span><span class="s">feature</span><span class="sh">'</span><span class="p">:</span><span class="n">features</span><span class="p">,</span><span class="sh">'</span><span class="s">X2</span><span class="sh">'</span><span class="p">:</span><span class="n">stats</span><span class="p">,</span><span class="sh">'</span><span class="s">DoF</span><span class="sh">'</span><span class="p">:</span><span class="n">dofs</span><span class="p">,</span><span class="sh">'</span><span class="s">pvalue</span><span class="sh">'</span><span class="p">:</span><span class="n">p_values</span><span class="p">,</span><span class="sh">'</span><span class="s">sig</span><span class="sh">'</span><span class="p">:[</span><span class="n">x</span><span class="o">&lt;=</span><span class="mf">0.05</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">p_values</span><span class="p">]})</span>
<span class="n">chi2_results</span><span class="p">.</span><span class="nf">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="sh">'</span><span class="s">X2</span><span class="sh">'</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">75</span>
<span class="n">axs</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="n">height</span><span class="o">=</span><span class="n">chi2_results</span><span class="p">[</span><span class="sh">'</span><span class="s">X2</span><span class="sh">'</span><span class="p">][:</span><span class="n">n</span><span class="p">])</span>
<span class="n">axs</span><span class="p">.</span><span class="nf">set_xticks</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">));</span>
<span class="n">axs</span><span class="p">.</span><span class="nf">set_xticklabels</span><span class="p">(</span><span class="n">chi2_results</span><span class="p">[</span><span class="sh">'</span><span class="s">feature</span><span class="sh">'</span><span class="p">][:</span><span class="n">n</span><span class="p">],</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
<span class="n">axs</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Results of Correlation Analysis (top 75 features)</span><span class="sh">'</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/2019-08-27-header-classifier-fig1.png" alt="png" /></p><h1 id="model-training">Model Training</h1><p><strong>Here we are building a model that can predict the column type using: i) the training data, and ii) the subset of engineered-features selected by correlation analysis.</strong></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="n">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="n">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">model_features</span> <span class="o">=</span> <span class="n">chi2_results</span><span class="p">[</span><span class="sh">'</span><span class="s">feature</span><span class="sh">'</span><span class="p">][:</span><span class="mi">100</span><span class="p">].</span><span class="n">values</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1"># model parameters
</span><span class="n">NB_params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">model__alpha</span><span class="sh">'</span><span class="p">:(</span><span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">)}</span>

<span class="n">NB_pipe</span> <span class="o">=</span> <span class="nc">Pipeline</span><span class="p">([(</span><span class="sh">'</span><span class="s">model</span><span class="sh">'</span><span class="p">,</span> <span class="nc">MultinomialNB</span><span class="p">())])</span>

<span class="n">gs_NB</span> <span class="o">=</span> <span class="nc">GridSearchCV</span><span class="p">(</span><span class="n">NB_pipe</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">NB_params</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">gs_NB</span> <span class="o">=</span> <span class="n">gs_NB</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">Xy_vect</span><span class="p">[</span><span class="n">model_features</span><span class="p">],</span> <span class="n">Xy_vect</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="n">gs_NB</span><span class="p">.</span><span class="n">best_score_</span><span class="p">,</span> <span class="n">gs_NB</span><span class="p">.</span><span class="n">best_params_</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>0.7691470588235294 {'model__alpha': 0.1}
</pre></table></code></div></div><h1 id="load-test-data">Load Test Data</h1><p>Here lets load the testing data. Note that the data is missing column headers. If we were cleaning up this data we would have to manually add these.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">testing_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path_model</span><span class="p">,</span><span class="n">x</span><span class="p">),</span><span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">data_path_model</span><span class="p">)</span> <span class="k">if</span> <span class="sh">'</span><span class="s">testing</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">testing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
<span class="n">testing_data</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></table></code></div></div><div><style scoped=""> .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; }</style><table border="1" class="dataframe"><thead><tr style="text-align: right;"><th><th>0<th>1<th>2<th>3<th>4<th>5<th>6<th>7<th>8<th>9<th>10<th>11<th>12<th>13<th>14<th>15<th>16<tbody><tr><th>0<td>11501 Maple Way<td>NaN<td>Louisville<td>KY<td>40229<td>38.097617<td>-85.659825<td>EUR 2274211.206<td>WBSW110<td>vmtjcbp@gmail.com<td>Jena Quilliams<td>039520 805 804<td>Jena<td>Quilliams<td>C<td>2<td>4795<tr><th>1<td>98 Lee Drive<td>NaN<td>Annapolis<td>MD<td>21403<td>38.933313<td>-76.493310<td>EUR 3405197.530<td>SWLP214<td>hdst@gmail.com<td>Laila Arpin<td>08249 265 6568<td>Laila<td>Arpin<td>B<td>2<td>5021<tr><th>2<td>126 Sunshine Road<td>O<td>Savannah<td>GA<td>31405<td>32.059784<td>-81.202271<td>EUR 7458286.525<td>VUYW948<td>aminwvel@yahoo.com<td>Cesar Severson<td>08-095 51-90<td>Cesar<td>Severson<td>A<td>0<td>5600<tr><th>3<td>4313 Wisconsin Street<td>#APT 000007<td>Anchorage<td>AK<td>99517<td>61.181060<td>-149.942792<td>€ 5481056.898<td>SEXL728<td>gevypgf@mail.kz<td>Chi Hollinsworth<td>030164-378 59 20<td>Chi<td>Hollinsworth<td>B<td>1<td>3746<tr><th>4<td>829 Main Street<td>NaN<td>Manchester<td>CT<td>6040<td>41.770678<td>-72.520917<td>GBP 4247524.506<td>VQZY333<td>yibhnaha@mail.kz<td>Jan Reagans<td>00132-612-74-32<td>Jan<td>Reagans<td>C<td>4<td>7541<tr><th>5<td>37 Spring Street<td>NaN<td>Groton<td>CT<td>6340<td>41.320683<td>-71.991475<td>$ 5717317.815<td>BSRO462<td>lppsimxwb@mail.kz<td>Marcos Hoistion<td>018-8094-25<td>Marcos<td>Hoistion<td>E<td>3<td>5201<tr><th>6<td>266 South J Street<td>NaN<td>Livermore<td>CA<td>94550<td>37.680570<td>-121.768021<td>$ 1921095.325<td>SNPX594<td>tgjt@aol.com<td>Loan Wadsworth<td>040 9272 23<td>Loan<td>Wadsworth<td>C<td>3<td>7463<tr><th>7<td>7952 South Algonquian Way<td>NaN<td>Aurora<td>CO<td>80016<td>39.573350<td>-104.716211<td>$ 8932865.979<td>ZNNS529<td>snjral@aol.com<td>Marisa Blaskovich<td>087 469 8912<td>Marisa<td>Blaskovich<td>B<td>0<td>7738<tr><th>8<td>9223 Elgin Circle<td>NaN<td>Anchorage<td>AK<td>99502<td>61.136803<td>-149.965463<td>GBP 3666134.645<td>ZCJN210<td>ebl@gmail.com<td>Nguyet Lytch<td>00748296 39 4<td>Nguyet<td>Lytch<td>A<td>1<td>6734<tr><th>9<td>224 Michael Sears Road<td>NaN<td>Belchertown<td>MA<td>1007<td>42.234610<td>-72.359730<td>EUR 2406344.382<td>ZOSG574<td>qeaf@aol.com<td>Corrie Tolhurst<td>053601-410-69-0<td>Corrie<td>Tolhurst<td>D<td>2<td>1521</table></div><p>Below we apply the same feature engineering and selection as applied to our training data.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">testing_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="p">.</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">data_path_model</span><span class="p">,</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">data_path_model</span><span class="p">)</span> <span class="k">if</span> <span class="sh">'</span><span class="s">testing</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">testing_data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">concat</span><span class="p">(</span><span class="n">testing_data</span><span class="p">)</span>
<span class="n">Xy_test</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nf">concat</span><span class="p">([</span><span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">:</span><span class="nf">list</span><span class="p">(</span><span class="n">testing_data</span><span class="p">[</span><span class="n">col</span><span class="p">]),</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">:</span><span class="n">col</span><span class="p">})</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">testing_data</span><span class="p">.</span><span class="n">columns</span><span class="p">])</span>
<span class="n">Xy_test</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">Xy_test</span><span class="p">.</span><span class="nf">fillna</span><span class="p">(</span><span class="sh">''</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># fill nan values with empty string
</span>
<span class="n">Xy_test</span> <span class="o">=</span> <span class="nf">feat_eng</span><span class="p">(</span><span class="n">Xy_test</span><span class="p">)</span>

<span class="n">test_vect</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="p">.</span><span class="nf">transform</span><span class="p">(</span><span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">X</span><span class="sh">'</span><span class="p">].</span><span class="nf">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">).</span><span class="nb">str</span><span class="p">.</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">))</span>
<span class="n">test_vect</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">test_vect</span><span class="p">.</span><span class="nf">todense</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="n">vectorizer</span><span class="p">.</span><span class="nf">get_feature_names</span><span class="p">())</span>
<span class="n">Xy_test</span> <span class="o">=</span> <span class="n">Xy_test</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">test_vect</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="sh">'</span><span class="s">left</span><span class="sh">'</span><span class="p">,</span><span class="n">left_index</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">right_index</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="nf">copy</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="how-good-is-the-model">How good is the model?</h3><p>Overall our model is able to correctly identify and label 77 % of the test data. Remember the model has never seen the test data before so that is pretty good.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">pred</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">gs_NB</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">Xy_test</span><span class="p">[</span><span class="n">model_features</span><span class="p">])</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Model accuracy: %.3f</span><span class="sh">'</span> <span class="o">%</span><span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">pred</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">]))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Model accuracy: 0.774
</pre></table></code></div></div><p>There are also some other things we could try to improve our model further. Below we see a more detailed report and bar plot that shows us how good our model was on each data column we were trying to predict. We could for isntance, look where our model is underperfoming and try to create and select other features that better capture the data fields.</p><p><a href="https://blog.exsilio.com/all/accuracy-precision-recall-f1-score-interpretation-of-performance-measures/">See this guide for interpretation of accuracy, precision, recall etc..</a></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nf">print</span><span class="p">(</span><span class="n">metrics</span><span class="p">.</span><span class="nf">classification_report</span><span class="p">(</span><span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">],</span> <span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">pred</span><span class="sh">'</span><span class="p">]))</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>              precision    recall  f1-score   support

    address1       0.53      0.99      0.69      1220
    address2       0.86      0.08      0.14      1220
        city       0.64      0.56      0.60      1220
       email       1.00      1.00      1.00      1220
  first_name       0.46      0.51      0.48      1220
   last_name       0.51      0.46      0.49      1220
         lat       0.98      1.00      0.99      1220
         lng       0.88      1.00      0.94      1220
       money       1.00      1.00      1.00      1220
     num_cat       0.82      1.00      0.90      1220
     numeric       0.70      0.68      0.69      1220
 person_name       0.88      0.98      0.92      1220
       phone       0.99      0.85      0.91      1220
   reference       1.00      0.96      0.98      1220
       state       0.80      0.50      0.61      1220
     txt_cat       0.74      1.00      0.85      1220
         zip       0.68      0.59      0.63      1220

   micro avg       0.77      0.77      0.77     20740
   macro avg       0.79      0.77      0.75     20740
weighted avg       0.79      0.77      0.75     20740
</pre></table></code></div></div><p><strong>The bar charts below show the distribution of predictions for each target.</strong></p><p>For instance:</p><ul><li><strong>address1</strong>: the model was able to identify all of the address1 values in the testing data.<li><strong>city</strong>: The model indentified roughly 50% of the correct city values, but often confused these with human names.</ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="n">fig</span><span class="p">,</span><span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">sharey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">target</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">].</span><span class="nf">unique</span><span class="p">(),</span><span class="n">axs</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()):</span>
    <span class="n">heights</span> <span class="o">=</span> <span class="n">Xy_test</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="n">Xy_test</span><span class="p">[</span><span class="sh">'</span><span class="s">Y</span><span class="sh">'</span><span class="p">]</span><span class="o">==</span><span class="n">target</span><span class="p">,</span><span class="sh">'</span><span class="s">pred</span><span class="sh">'</span><span class="p">].</span><span class="nf">value_counts</span><span class="p">()</span>
    <span class="n">x</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">heights</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">height</span><span class="o">=</span><span class="n">heights</span><span class="o">/</span><span class="mi">1220</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">,</span><span class="n">edgecolor</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xticks</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_xticklabels</span><span class="p">(</span><span class="n">heights</span><span class="p">.</span><span class="n">index</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="n">target</span><span class="p">)</span>
    
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
</pre></table></code></div></div><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/2019-08-27-header-classifier-fig2.png" alt="png" /></p><p>That’s all folks.<br /> Thank you for reading.</p><p>Ben Postance</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blog-post/'>blog-post</a>, <a href='/categories/data-analysis/'>data-analysis</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/data-cleaning/" class="post-tag no-text-decoration" >data-cleaning</a> <a href="/tags/classification/" class="post-tag no-text-decoration" >classification</a> <a href="/tags/machine-learning/" class="post-tag no-text-decoration" >machine-learning</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Using machine learning to cleanse datasets: classifying column headers in data tables - Ben Postance&url=https://bpostance.github.io/posts/header-classifier/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Using machine learning to cleanse datasets: classifying column headers in data tables - Ben Postance&u=https://bpostance.github.io/posts/header-classifier/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Using machine learning to cleanse datasets: classifying column headers in data tables - Ben Postance&url=https://bpostance.github.io/posts/header-classifier/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/building-ai-enterprise/">How to build an Advanced Analytics function</a><li><a href="/posts/multi-tasking-in-python/">Multi-tasking in Python</a><li><a href="/posts/airflow-taskflow/">Writing Pythonic Airflow DAGs with the TaskFlow API</a><li><a href="/posts/finCEN/">The finCEN files: Uncovering money laundering patterns in the global banking network</a><li><a href="/posts/working-with-MODIS-data/">Geospatial Analysis: Working with MODIS data</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/bayes-theory/">bayes-theory</a> <a class="post-tag" href="/tags/bayesian-inference/">bayesian-inference</a> <a class="post-tag" href="/tags/data-mining/">data-mining</a> <a class="post-tag" href="/tags/monte-carlo/">monte carlo</a> <a class="post-tag" href="/tags/classification/">classification</a> <a class="post-tag" href="/tags/clustering/">clustering</a> <a class="post-tag" href="/tags/data-cleaning/">data-cleaning</a> <a class="post-tag" href="/tags/decomposition/">decomposition</a> <a class="post-tag" href="/tags/dimension-reduction/">dimension-reduction</a> <a class="post-tag" href="/tags/geospatial-analysis/">geospatial-analysis</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/introduction-to-hashing/"><div class="card-body"> <span class="timeago small" > Jun 10, 2019 <i class="unloaded">2019-06-10T21:00:01+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>An introduction to hashing functions for data mining</h3><div class="text-muted small"><p> This post is intended to provide a quick introduction to hash functions and to discuss some practical applications of hashes in data mining and machine learning. The aim of this post is to provide ...</p></div></div></a></div><div class="card"> <a href="/posts/espl-landslide-threshold-classification/"><div class="card-body"> <span class="timeago small" > Mar 2, 2019 <i class="unloaded">2019-03-02T18:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Earth Surface Processes and Landforms: classficiation of rare events for landslide early warning systems</h3><div class="text-muted small"><p> Link to my 2018 paper in ESPL. Abstract Translational landslides and debris flows are often initiated during intense or prolonged rainfall. Empirical thresholds aim to classify the rain conditio...</p></div></div></a></div><div class="card"> <a href="/posts/finCEN/"><div class="card-body"> <span class="timeago small" > Sep 21, 2020 <i class="unloaded">2020-09-21T19:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>The finCEN files: Uncovering money laundering patterns in the global banking network</h3><div class="text-muted small"><p> Jupyter notebook here The Financial Crimes Enforcement Network (finCEN) files are more than 2,500 documents, most of which were suspicious activity reports (SARs) files that banks sent to the US ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/introduction-to-hashing/" class="btn btn-outline-primary" prompt="Older"><p>An introduction to hashing functions for data mining</p></a> <a href="/posts/docker-fask-api/" class="btn btn-outline-primary" prompt="Newer"><p>How to containerize a simple Rest API using Python Flask</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//https-bpostance-github-io.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Using machine learning to cleanse datasets: classifying column headers in data tables'; this.page.url = 'https://bpostance.github.io/posts/header-classifier/'; this.page.identifier = '/posts/header-classifier/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">BenPostance</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."> Some rights reserved. </span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/bayes-theory/">bayes theory</a> <a class="post-tag" href="/tags/bayesian-inference/">bayesian inference</a> <a class="post-tag" href="/tags/data-mining/">data mining</a> <a class="post-tag" href="/tags/monte-carlo/">monte carlo</a> <a class="post-tag" href="/tags/classification/">classification</a> <a class="post-tag" href="/tags/clustering/">clustering</a> <a class="post-tag" href="/tags/data-cleaning/">data cleaning</a> <a class="post-tag" href="/tags/decomposition/">decomposition</a> <a class="post-tag" href="/tags/dimension-reduction/">dimension reduction</a> <a class="post-tag" href="/tags/geospatial-analysis/">geospatial analysis</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://bpostance.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
